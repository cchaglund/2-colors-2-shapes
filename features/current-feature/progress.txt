## THEME-1: CSS Variables Infrastructure — DONE

Implemented full CSS custom properties-based theming: 4 themes (A/B/C/D) × 2 modes (light/dark) = 8 variants.

### Key decisions
- Theme B (Minimal Swiss) as default — closest to existing design, uses already-loaded DM Sans
- `data-theme` + `data-mode` on `<html>` replaces old `.dark` class
- Added `@custom-variant dark (&:is([data-mode="dark"] *))` for Tailwind v4 dark: compatibility
- SVG elements use `style` prop (not attrs) for CSS var colors — attrs don't support var()
- Tailwind v4 `--radius-*` vars overridden per theme → existing rounded-* classes auto-adapt
- Artwork overlays (bg-black/70 text-white on thumbnails) left hardcoded — need guaranteed contrast
- Google Fonts lazy-loaded on theme switch via dynamic <link> injection
- `--color-accent-text` var used for text on accent buttons (white for most themes, black for Theme D neon yellow)

### Files changed
- `src/index.css` — complete rewrite with 8 theme/mode variant selectors, ~50 CSS vars each
- `src/hooks/ui/useThemeState.ts` — ThemeName type, data-attr management, font loading, transitions
- `src/App.tsx` — passes theme/mode props to CanvasEditorPage
- `src/components/canvas/CanvasEditorPage.tsx` — new theme props in interface
- `src/components/canvas/Toolbar.tsx` — passes theme props to ThemeToggle
- `src/components/canvas/ThemeToggle.tsx` — rewrite with A/B/C/D + light/dark/auto buttons
- `src/components/canvas/TransformHandles.tsx` — SVG colors → CSS vars via style prop
- `src/components/canvas/Canvas.tsx` — marquee/fallback colors → CSS vars
- `src/components/canvas/CanvasGridLines.tsx` — grid line colors → CSS vars
- `src/components/canvas/TouchContextMenu.tsx` — hardcoded Tailwind → CSS vars
- `src/components/LayerPanel/GroupHeader.tsx` — red/blue/black → danger/accent/hover vars
- `src/components/LayerPanel/LayerItem.tsx` — same pattern
- `src/components/LayerPanel/LayerPanel.tsx` — accent button text
- `src/components/shared/InfoTooltip.tsx` — tooltip colors → CSS vars
- `src/components/shared/SubmissionThumbnail.tsx` — gray/blue → CSS vars
- `src/components/modals/WelcomeModal.tsx` — gray/white → CSS vars
- `src/components/modals/WinnerAnnouncementModal.tsx` — accent text
- `src/components/modals/CongratulatoryModal.tsx` — accent text
- `src/components/modals/OnboardingModal.tsx` — accent text
- `src/components/voting/VotingOptInPrompt.tsx` — accent text
- `src/components/voting/VotingConfirmation.tsx` — accent text
- `src/components/voting/VotingPairView.tsx` — accent overlay + danger hover text
- `src/components/social/FollowButton.tsx` — danger/accent → CSS vars
- `src/components/social/LoginPromptModal.tsx` — accent text
- `src/components/canvas/KeyboardSettingsModal.tsx` — accent text
- `src/components/canvas/ResetConfirmModal.tsx` — danger button text
- `src/components/Wall/WallContent.tsx` — danger + accent hover text
- `src/components/Wall/WallCalendarPicker.tsx` — accent text
- `src/components/FriendsFeed/FriendsFeedContent.tsx` — danger + accent hover text
- `src/components/admin/Dashboard.tsx` — danger + accent spinner/buttons
- `src/components/submission/LikeButton.tsx` — danger colors
- `src/test/SocialTestPage.tsx` — accent text throughout
- `src/test/VotingTestPage.tsx` — accent text throughout
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Lint and tests can't run in this VM (esbuild/eslint-plugin-react-hooks need Node 22+, VM has Node 20)
- TypeScript typecheck passes clean (TS 5.7; project targets 5.9 but 5.7 catches all real errors)
- ColorTester.tsx (admin) still has hardcoded red/green — intentional, it's a color testing tool
- `toggleDarkMode` removed from prop chain (App → CanvasEditorPage → Toolbar → ThemeToggle) — mode selection UI handles light/dark/system directly via onSetMode

## THEME-2: Theme A (Pop Art) — DONE

Theme A CSS vars already defined in THEME-1. This task addressed three gaps:

### Key decisions
- Cyan (#33CCFF) added to dot pattern overlay (pink+cyan dual-layer dots at 20px/33px grids = pop art feel)
- `font-display` class applied to h1 headings + inspiration word → Lilita One shows in Theme A, no-op for B/C/D (same as body font)
- `theme-pattern` class applied to page backgrounds (Gallery, Submission Detail, Winners Day, User Profile, Wall of the Day)
- `.theme-pattern` CSS fixed: isolation:isolate + z-index:-1 so pattern renders behind content
- Canvas editor page excluded from theme-pattern (has checkered canvas bg)
- Inspiration word bumped from text-base to text-lg for better display font impact

### Files changed
- `src/index.css` — Theme A light+dark: dual-layer pattern-image (pink+cyan), --pattern-size override; .theme-pattern: isolation:isolate, z-index:-1
- `src/components/canvas/Toolbar.tsx` — inspiration word: +font-display, text-base→text-lg
- `src/components/pages/GalleryPage.tsx` — h1: +font-display; outer div: +theme-pattern
- `src/components/pages/WinnersDayPage.tsx` — same pattern
- `src/components/pages/SubmissionDetailPage.tsx` — same
- `src/components/pages/UserProfilePage.tsx` — same
- `src/components/pages/WallOfTheDayPage.tsx` — same
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- VM filesystem corrupts large npm files during install; tests/lint still can't run
- TypeScript typecheck passes clean (TS 5.8.3 manually extracted from tarball)
- Dev server crashes on first CSS request (lightningcss/oxide binary compat issues)

## THEME-3: Theme B (Minimal Swiss) — DONE

CSS vars for Theme B already defined in THEME-1 (colors, fonts, radii, shadows). Only gap: `--sel-dash: 4 4` existed but wasn't consumed by TransformHandles.tsx — bounding box always rendered solid.

### Key decisions
- Applied `strokeDasharray: 'var(--sel-dash)'` via style prop on SVG bounding box rects
- `stroke-dasharray: 0` (themes A/C/D) = solid per SVG spec (sum of dashes = 0 → treated as none)
- `stroke-dasharray: 4 4` (theme B) = dashed
- Dashes don't zoom-scale (fixed canvas coords); acceptable for now, THEME-7 can refine

### Files changed
- `src/components/canvas/TransformHandles.tsx` — added `strokeDasharray: 'var(--sel-dash)'` to 3 bounding box rects (TransformVisualLayer, MultiSelectTransformLayer single + multi)
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Same VM limitations as before (no lint/tests, typecheck passes clean)

## THEME-4: Theme C (Soft Cloud) — DONE

All CSS vars + font loading + pattern already complete from prior work. No code gaps found.

### Verification
- CSS vars: sage green sel (#9DC4B0), coral accent (#E07A5F), cream bgs (#fdf8f3), warm dark (#2a2520) — light+dark ✓
- Nunito font: configured in THEME_FONT_URLS (400/500/600/700), lazy-loaded on switch ✓
- Radii: 12-28px (very rounded) ✓
- Shadows: diffuse soft (0 4px 20px rgba(0,0,0,0.05)) ✓
- Pattern: subtle circular dots via radial-gradient, 3% opacity light / 2% dark, 16px grid ✓
- theme-pattern class on pages (Gallery, Submission Detail, etc.) — applied in THEME-2 ✓
- font-display class on headings — no-op for Theme C (Nunito = both body+display) ✓
- strokeDasharray via --sel-dash: 0 — solid selection borders ✓
- Typecheck: passes clean

### Files changed
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- No code changes needed — THEME-1 infrastructure + THEME-2/3 generic fixes covered all Theme C requirements
- Could not visually verify in browser (Playwright network isolation from Vite dev server)

## THEME-5: Theme D (Brutalist) — DONE

All CSS vars + font loading already complete from THEME-1 infrastructure. No code gaps found.

### Verification
- CSS vars: neon yellow #CCFF00 accent, black/white stark bgs, heavy borders — light+dark ✓
- Space Mono font: configured in THEME_FONT_URLS (400/700), lazy-loaded on switch ✓
- Radii: all 0px (zero rounding) ✓
- Shadows: thick offsets (6px card, 4px btn, 10px modal) with solid black (light) or neon glow (dark) ✓
- Borders: 3px standard, 4px heavy ✓
- Pattern: none (--pattern-image: none, --pattern-opacity: 0) ✓
- Selection: neon yellow borders, black fill, neon stroke, square handles (--sel-handle-size: 10px) ✓
- Typecheck: passes clean

### Files changed
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- No code changes needed — THEME-1 infrastructure covered all Theme D requirements
- Same VM limitations (no lint/tests)

## LAYOUT-1: Top Bar — DONE

Created fixed 56px top bar replacing sidebar header. Layout restructured from single h-screen to flex-col (TopBar + canvas area).

### Key decisions
- TopBar is flexible component: accepts `centerContent` + `rightContent` props for page-specific content
- Canvas editor: center = InspirationCenter (label + word), right = Reset/Submit/Gallery/Login buttons
- Gallery page: center = "Gallery" title, right = "< Back to canvas" link
- Submission page: center = "Submission" title, right = nav arrows + "< Gallery" link
- ThemePill: grouped pill with sun/moon toggle + divider + A/B/C/D buttons, active theme filled with accent
- Sidebars now position relative to canvas area wrapper (below top bar), not full viewport
- Toolbar slimmed: removed logo, account, gallery, friends, inspiration, save/reset, theme toggle — kept bg colors, shape colors, add shape, view toggles, controls
- TopBar z-30 > sidebars z-20 > floating toolbars z-10
- Theme props passed from App.tsx → GalleryPage and SubmissionDetailPage

### Files changed
- `src/components/canvas/TopBar.tsx` — NEW: TopBar + ThemePill + InspirationCenter components
- `src/components/canvas/Toolbar.tsx` — removed logo/account/gallery/friends/inspiration/save/reset/theme sections + their props
- `src/components/canvas/CanvasEditorPage.tsx` — flex-col layout, TopBar at top, canvas area in flex-1 relative wrapper
- `src/components/pages/GalleryPage.tsx` — TopBar with Gallery center + Back to canvas right
- `src/components/pages/SubmissionDetailPage.tsx` — TopBar with Submission center + Gallery back right
- `src/App.tsx` — passes theme props to GalleryPage and SubmissionDetailPage
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Playwright can't reach local Vite dev server (network isolation) — no visual verification
- TypeScript typecheck passes clean
- BackToCanvasLink component still used by other pages (WinnersDayPage, UserProfilePage, etc.) — not removed

## THEME-6: Theme Switcher UI — DONE (already complete from LAYOUT-1)

ThemePill component built as part of LAYOUT-1 already satisfies all THEME-6 requirements: sun/moon dark mode toggle, divider, A/B/C/D theme buttons with accent-filled selected state, smooth transitions via triggerThemeTransition(), localStorage persistence via useThemeState.

### Files changed
- `features/current-feature/PRD.json` — marked passes: true

## LAYOUT-4: Bottom Floating Toolbar — DONE

Floating horizontal pill toolbar at bottom center of canvas editor with spring entrance animation.

### Key decisions
- `EditorTool` type: `'select' | 'stamp-0' | 'stamp-1'` — stamp tool toggles back to select if clicked again
- `selectedColorIndex` state added to CanvasEditorPage — determines color for new shapes (used by STAMP-1 later)
- Zoom controls moved to bottom-right to avoid overlap (aligns with ZOOM-1 intent)
- Background "cream/white" option uses `null` backgroundColorIndex (existing behavior for no custom bg)
- Color/bg swatches use `challenge.colors` dynamically — works with any color count
- Labels "Color" and "Background" per PRD; dividers separate all 3 sections

### Files changed
- `src/components/canvas/BottomToolbar.tsx` — NEW: BottomToolbar + EditorTool type, ToolButton, ColorSwatch, Divider sub-components
- `src/components/canvas/CanvasEditorPage.tsx` — import BottomToolbar, add editorTool/selectedColorIndex state, render toolbar at bottom center, move ZoomControls to bottom-right
- `features/current-feature/PRD.json` — marked LAYOUT-4 + THEME-6 passes: true

### Blockers / notes
- Lint/tests still can't run in VM (binary compat issues); typecheck passes clean
- STAMP-1 will wire up canvas click → addShape using editorTool + selectedColorIndex
- ZOOM-1 (zoom controls relocation) partially addressed by move to bottom-right; ZOOM-1 still covers range extension + reset button

## STAMP-1: Stamp Mode — Shape Creation — DONE

Stamp mode: click canvas to place shapes, drag to size, ghost cursor follows mouse.

### Key decisions
- New `useStampMode` hook encapsulates all stamp interaction logic (ghost tracking, click-to-place, drag-to-size, Esc/V exit)
- `addShape` extended with optional `{ x, y, size }` — x/y are center coords (shape offset by -size/2)
- Ghost cursor: SVGShape at 0.35 opacity, 60x60, rendered in canvas SVG coords (auto-scales with zoom/pan)
- Click-to-place: default 60px size. Drag-to-size: canvas-coord distance * 2, min 20px
- In stamp mode: canvas bg click, shape click, and SVG click all route to stamp handler (stamps through existing shapes)
- Esc/V keydown exits stamp mode → select; handled in useStampMode, not useCanvasKeyboardShortcuts (separate concern)
- Ghost hides during drag (no preview during sizing)
- Hint text "Click to place · Drag to size · Esc to select" floats above bottom toolbar, pointer-events: none

### Files changed
- `src/hooks/canvas/useStampMode.ts` — NEW: stamp mode hook (ghost state, mouse handlers, keyboard exit)
- `src/hooks/canvas/useShapeOperations.ts` — addShape accepts optional `{ x, y, size }` param
- `src/components/canvas/Canvas.tsx` — imports useStampMode + SVGShape, new props (editorTool, selectedColorIndex, onAddShape, onSetTool), stamp mode intercepts all mousedown events, renders ghost cursor
- `src/components/canvas/CanvasEditorPage.tsx` — passes editorTool/selectedColorIndex/addShape/setEditorTool to Canvas, adds stamp hint text
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Spring animation for newly placed shapes (ANIM-1) not implemented here — separate PRD item
- Typecheck passes clean; lint/tests can't run in VM

## LAYOUT-2: Left Tools Panel — DONE

Replaced wide 300px left sidebar (Toolbar) with slim 52px vertical icon-only tools panel (ToolsPanel).

### Key decisions
- 52px fixed width, no resize handle (icon-only panel doesn't need resizing)
- All icons inline SVG, 18x18, matching ActionToolbar style
- ToolButton with hover tooltip appearing to the right (since panel is on left edge)
- Bring forward/send backward: iterate selected shapes sorted by z-index to avoid collision
- Rotation buttons removed per PRD (keyboard + handles only)
- Active state for grid/off-canvas toggles via `active` prop on ToolButton
- Wrench icon for collapsed toggle button (40x40, top-left)
- Old Toolbar component not deleted — REMOVE-1 handles final cleanup
- ActionToolbar not deleted — REMOVE-2 handles that (but it's now redundant)

### Files changed
- `src/components/canvas/ToolsPanel.tsx` — NEW: slim vertical icon-only tools panel
- `src/components/canvas/CanvasEditorPage.tsx` — replaced Toolbar with ToolsPanel in left sidebar, added handleBringForward/handleSendBackward, removed leftWidth/startResizeLeft usage, removed ActionToolbar
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- VM can't run lint/tests/build (binary compat); typecheck passes clean
- `handleRotateShapes` now unused in CanvasEditorPage (was only passed to ActionToolbar) — REMOVE-2 cleanup
- `openKeyboardSettings` no longer triggered from UI (old Toolbar "Customize" removed) — INFO-1 will add new trigger

## LAYOUT-3: Right Layers Panel — DONE

Replaced 300px resizable right sidebar with compact 240px fixed-width floating layers panel.

### Key decisions
- Fixed 240px width, no resize handle (compact panel doesn't need resizing)
- Header redesigned: layers stack icon + "Layers" text + count badge + group icon button (4-square grid) + X close button
- Group/Ungroup text buttons removed from body; group = icon button in header, ungroup = icon button per group header row
- Ungroup icon on each GroupHeader directly — more discoverable than header-level button requiring shape selection
- Close button changed from chevron to X icon (clearer intent)
- Collapsed toggle: layers icon + shape count badge in top-right corner (was plain chevron arrow)
- `onStartResize` removed from LayerPanelProps (no longer resizable)

### Files changed
- `src/components/LayerPanel/types.ts` — removed `onStartResize`, added `onUngroupShapes` to GroupHeaderProps
- `src/components/LayerPanel/LayerPanel.tsx` — removed resize handle, redesigned header, removed Group/Ungroup text buttons, removed dead code
- `src/components/LayerPanel/GroupHeader.tsx` — added ungroup icon button per group row
- `src/components/canvas/CanvasEditorPage.tsx` — fixed width 240px, updated collapsed toggle with layers icon + count, removed rightWidth/startResizeRight usage
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Layer row action buttons kept as hover-reveal on desktop, always-visible on touch — 240px too narrow for all 5 inline
- Typecheck + dev server start clean
- `useSidebarState` still exports rightWidth/startResizeRight — harmless, REMOVE-1 can clean later

## THEME-7: Selection Handle Theming & Restructuring — DONE

Restructured transform/selection handles and made all handle styling theme-driven via CSS variables.

### Key decisions
- Resize handles: 4 corners → 8 (nw, n, ne, e, se, s, sw, w); midpoint handles work with existing resize logic since it uses grab-position vectors, not corner IDs
- Rotation handles: 4 sides → 1 top center only with visible stem line from bounding box edge
- `--sel-handle-radius` CSS var: 50% (circular) for A/C, 15% (barely rounded) for B, 0 (square) for D — applied via SVG `rx`/`ry` style props
- Handle fill uses `--sel-handle-fill` + `--sel-handle-stroke` (was using `--sel-border` for stroke)
- Rotation handle/stem uses `--sel-rotate-color` (was defined but unused, now consumed)
- Hover 1.3x: React state `hoveredHandleId` in Canvas.tsx, passed from interaction layer (onMouseEnter/Leave) to visual layer; visual handles use CSS `transform: scale(1.3)` with `transformBox: fill-box` + `transformOrigin: center` + 0.15s transition
- Multi-select individual outlines: changed from shape-traced dashed outline (using element/props from getShapeSVGData) to minimal dashed bounding-box rects using `--sel-border` color at 60% opacity — simpler, more "minimal" per PRD
- Extracted `buildShapeTransform()` helper to DRY up repeated transform string construction (was duplicated 6+ times)
- `getEffectiveCursor()` extended with midpoint vectors (n, e, s, w) for correct cursor orientation

### Files changed
- `src/index.css` — added `--sel-handle-radius` to all 5 theme blocks (A=50%, B=15%, C=50%, D=0, fallback=15%)
- `src/components/canvas/TransformHandles.tsx` — major rewrite: getCorners→getResizeHandles (8 handles), getRotationHandles→getRotationHandle (1 handle), theme CSS vars on all visual elements, hover scale via props, buildShapeTransform helper, minimal multi-select outlines
- `src/components/canvas/Canvas.tsx` — added useState import, hoveredHandleId state, passed onHandleHover/hoveredHandleId to transform layers

### Blockers / notes
- Typecheck passes clean, dev server starts clean
- Handle size (--sel-handle-size) CSS var defined per theme but not consumed in JS — handles use BASE_HANDLE_SIZE=10 constant for canvas-coordinate math; the visual size difference (7-10px) is subtle and the theme distinction comes primarily from shape (radius), color, and stroke
- `resizeCorner` field in DragState still typed as `string` — accepts midpoint IDs without changes

## PANEL-1: Collapsible Side Panels — DONE (already complete from LAYOUT-2 + LAYOUT-3)

All PANEL-1 requirements already implemented: AnimatePresence spring animations (stiffness 400, damping 20), multi-step exit animation, toggle buttons (wrench icon top-left, layers+count top-right), absolute positioning over canvas, localStorage persistence via useSidebarState.

### Files changed
- `features/current-feature/PRD.json` — marked passes: true

## SHORTCUT-1: Default Key Remapping — DONE

Remapped defaults: V→selectMode, M→mirrorHorizontal, Shift+M→mirrorVertical. Old H/V bindings replaced.

### Key decisions
- Added `selectMode` to KeyboardActionId type + KEYBOARD_ACTIONS array (category: navigation, remappable)
- V key now handled by keyboard shortcuts system (useCanvasKeyboardShortcuts) not hardcoded in useStampMode
- Escape kept as hardcoded universal cancel in useStampMode (not remappable — Esc is always escape)
- Settings version bumped 1→2 with migration: only remaps if user was on old defaults (H→M, V→Shift+M), preserves custom bindings
- Supabase migration: detects pre-v2 by absence of `selectMode` key, applies same migration + persists

### Files changed
- `src/constants/keyboardActions.ts` — added `selectMode` to type + KEYBOARD_ACTIONS, changed mirrorH default KeyH→KeyM, mirrorV default KeyV→KeyM+shift
- `src/hooks/ui/useKeyboardSettings.ts` — CURRENT_VERSION 1→2, migrateV1ToV2() for localStorage + Supabase paths
- `src/hooks/canvas/useCanvasKeyboardShortcuts.ts` — added onSelectMode callback, selectMode binding check (first in handler)
- `src/hooks/canvas/useStampMode.ts` — removed hardcoded V key, kept only Escape
- `src/components/canvas/Canvas.tsx` — wired handleSelectMode→onSetTool('select') to keyboard shortcuts hook
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Typecheck passes clean
- selectMode appears in KeyboardSettingsModal under "Canvas Navigation" alongside Pan
- toggleGrid (category: 'view') not shown in settings modal — pre-existing gap, not introduced here

## REMOVE-1: Old Sidebar Content — DONE

Deleted orphaned Toolbar.tsx (old 300px left sidebar). All functions already migrated in prior work.

### Verification
- Toolbar.tsx had zero imports across codebase — completely dead code since LAYOUT-2 replaced it with ToolsPanel
- Logo/branding → TopBar ✓
- Auth/login → TopBar ✓
- Gallery link → TopBar ✓
- Inspiration word → TopBar (InspirationCenter) ✓
- Background + shape colors → BottomToolbar ✓
- Shape adding → BottomToolbar stamp mode ✓
- Save/Submit + Reset → TopBar ✓
- Theme toggle → TopBar (ThemePill) ✓
- Grid/off-canvas toggles → ToolsPanel ✓
- Keyboard shortcuts info → INFO-1 (separate pending task, '?' popover)
- Typecheck passes clean

### Files changed
- `src/components/canvas/Toolbar.tsx` — DELETED (234 lines of dead code)
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- ActionToolbar.tsx also orphaned — REMOVE-2 will handle that
- INFO-1 ('?' popover for keyboard shortcuts) still pending — last REMOVE-1 verification step depends on it

## GALLERY-1: Gallery Top Bar and Tab Structure — DONE (already complete from prior work)

All GALLERY-1 requirements already implemented: TopBar with logo+theme toggles left, 'Gallery' center, '< Back to canvas' right. CalendarViewToggle pill-style tab bar with 4 tabs (My Submissions, Winners, Wall, Friends), active tab highlighted with `bg-(--color-selected)`. Theme applied via CSS vars throughout.

### Files changed
- `features/current-feature/PRD.json` — marked passes: true

## INFO-1: Keyboard Shortcuts Popover — DONE

30x30 '?' button in bottom-left corner of canvas editor. Opens animated popover listing all keyboard shortcuts.

### Key decisions
- Shortcuts read from `keyMappings` (user's actual bindings, not hardcoded) via `formatKeyBinding()`
- Movement keys (↑↓←→) condensed into single row; rotation (,/.) condensed into single row
- Static entries added for non-remappable shortcuts: Esc (exit stamp), Shift+Click (multi-select), Space+Drag (pan), Ctrl/⌘+Scroll (zoom)
- Esc appended to selectMode binding display ("V / Esc") since Esc is hardcoded in useStampMode
- Mac detection for Ctrl vs ⌘ label on zoom shortcut
- "Customize shortcuts" footer button closes popover and opens KeyboardSettingsModal via `openKeyboardSettings`
- AnimatePresence scale+fade animation (0.15s), popover anchored bottom-left above trigger
- Click-outside and Escape-key close handlers

### Files changed
- `src/components/canvas/KeyboardShortcutsPopover.tsx` — NEW: popover component with '?' trigger
- `src/components/canvas/CanvasEditorPage.tsx` — import + render KeyboardShortcutsPopover in bottom-left of canvas area
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Typecheck passes clean; dev server starts without compilation errors
- Could not visually verify in browser (Supabase network isolation prevents app rendering)

## REMOVE-2: Old Action Toolbar — DONE

Deleted orphaned ActionToolbar.tsx and removed dead `handleRotateShapes` code.

### Verification
- ActionToolbar.tsx had zero imports — completely dead since LAYOUT-2 replaced it with ToolsPanel ✓
- Undo, redo, duplicate, delete, move, size, mirror, bring forward, send backward → all in ToolsPanel ✓
- Rotation → keyboard shortcuts (,/.) + drag handles only, no button ✓
- Grid/off-canvas toggles → ToolsPanel ✓
- `handleRotateShapes` was unused — rotation handled by useCanvasKeyboardShortcuts (direct onUpdateShapes) + TransformHandles (mouse drag) ✓
- Typecheck: passes clean

### Files changed
- `src/components/canvas/ActionToolbar.tsx` — DELETED (359 lines dead code)
- `src/components/canvas/CanvasEditorPage.tsx` — removed unused `handleRotateShapes` destructuring
- `src/hooks/canvas/useShapeActions.ts` — removed `handleRotateShapes` function + export, updated JSDoc
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Tests/lint can't run in VM (binary compat issues, pre-existing)
- No orphaned toolbar UI remains from old design

## ZOOM-1: Zoom Controls Relocation and Range — DONE

Zoom controls already at bottom-right (LAYOUT-4). Extended range + added 1:1 reset button.

### Key decisions
- MIN_ZOOM 0.1→0.25, MAX_ZOOM 5→4 per PRD (0.25x–4x range)
- Added "1:1" reset button separated by vertical divider, disabled at 100% (same as % display)
- Outer container uses `rounded-(--radius-pill)` for theme-responsive pill shape (was hardcoded rounded-lg)
- Kept existing button order (−, %, +) and appended 1:1 — more intuitive than PRD's listed order

### Files changed
- `src/hooks/canvas/useViewportState.ts` — MIN_ZOOM 0.1→0.25, MAX_ZOOM 5→4
- `src/components/canvas/ZoomControls.tsx` — added 1:1 button + divider, pill border radius
- `features/current-feature/PRD.json` — marked passes: true

### Blockers / notes
- Typecheck passes clean; lint/tests fail (pre-existing VM binary compat)
- handleZoomIn/Out in CanvasEditorPage uses ±0.1 step — works fine within new 0.25–4 range
